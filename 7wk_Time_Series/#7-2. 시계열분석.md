# Time Series Analysis

@조효원
> **시계열 데이터에 대한 통계 모델의 필요성**

### 시계열 분석; 통계 모델과 신경망 모델
시계열 데이터란 순서 정보가 있는 데이터를 의미한다. 전통적으로 시계열 데이터를 처리하기 위해 ARIMA, seasonal ARIMA, Prophet 모형 등의 통계 모델들을 사용해왔다. 하지만 최근 딥러닝 모델의 비약적인 발전과 이 모델들이 시계열 데이터에 대한 좋은 성능을 보이자, 전통적인 통계 모델들의 필요성에 대한 의구심이 들기 시작했다. 통계 모델의 필요성에 대한 근본적인 문제가 제기된 것이다. 그럼에도 불구하고 통계 모델을 학습해야 하는 이유는 단순하다. 모델을 완전히 이해하고 아이디어를 얻어 발전시키기 위함이다. 

### 1. 역사에서 배운다

현 딥러닝 모델을 완전히 이해하기 위해서는 통계 모델의 구조와 아이디어를 학습할 필요가 있다. 이는 최신 딥러닝 모델들이 통계 모델에서 사용하는 기법을 차용한 경우가 많기 때문이다. 가장 대표적인 예는 AR(Auto-Regressive)이다. AR은 t시점의 데이터를 표현하기 위해 t-1 시점의 데이터를 이용하는 것이다. ARIMA 모델에서 직접적으로 활용된 이 아이디어는 RNN부터 시작해 GPT에 이루기까지, 언어 모델을 구축하는데 가장 핵심적인 요소로 활용되었다. 최근 가장 주목받은 모델은 BERT로 이는 AR을 제거한 언어모델이지만, BERT를 개선한 모델들이 모두 AR을 추가했다는 점에 주목해야한다. XLNet, MASS, BART 모두 BERT의 AE(Auto-Encoding)에 AR을 결합한 모델이다. 

푸리에 계수를 시계열에 적용해 성분을 추출하는 아이디어도 많이 활용된다. 대표적인 분야는 음성 처리이다. 딥러닝에서 음성은 spectrogram이라고 불리는 3차원 데이터로 처리된다. 이는 주파수와 진폭의 시간에 따른 변화를 보여주는 하나의 그림이다. 해당 그래프 $F(x)$는 sin, cos함수의 선형 결합으로 이루어진다. 따라서, 계절성과 유사하게 spectrogram을 모델링할 수 있는 것이다. 뿐만 아니라, Transformer에서 소개된 Positional Encoding도 푸리에 계수의 기본 아이디어를 사용한 것이다. Transformer는 한 단어의 위치를 표현하기 위해서 sin, cos 함수를 이용한다. 

이처럼, 딥러닝 모델들에서 사용된 아이디어들은 사실 완전히 새로운 것이 아니다. 따라서 해당 모델을 완전히 이해하기 위해서는 그것의 역사인 통계 모델들을 공부할 필요가 있다. 

### 2. Improving Performance

딥러닝 모델은 거의 모든 도메인의 분류/예측 문제에서 비교 불가한 성능 향상을 보였다. 주목해야할 점은, 딥러닝 모델에서 일정한 성능을 내기 위해 그 도메인에 대한 지식이 거의 필요하지 않다는 것이다. 예를 들어, 언어 모델을 만들기 위해 필요한 언어학적 지식은 '문장이 토큰 단위로 이루어진다, 순서가 있는 데이터이다' 정도이다. 심지어 Frederick Jelinek은 "내가 언어학자를 해고 할 때마다 음성 인식기의 성능이 올라간다."라고 언급했다. 즉, 딥러닝 모델을 만들기 위해 사실 도메인 지식은 중요하지 않다. 그럼에도 불구하고, 우리가 도메인 지식을 잘 알아야하는 이유는 다음과 같다. 

> In language modeling, as well as in tasks such as machine translation, neural networks have **now reached a sufficiently high level of performance** that accurately measuring their syntactic abilities and **improving those abilities further will require more sophisticated evaluation methods** (Tal Linzen, 2019). 

딥러닝 모델은 이미 좋은 성능을 보이지만, 이를 더 발전시키기 위해서는 도메인 지식이 필요하다. 그리고 도메인 지식을 풍부하게 활용하고 분석하는 통계 모델들은 딥러닝 모델의 성능을 보다 향상하는데 도움을 줄 것이다. 

### 3. Hybrid Models

통계 모델과 딥러닝 모델을 결함한 Hybrid 모델들도 존재한다. 대표적인 예시가 ARIMA-LSTM 모델이다. Temür et al.(2019)에 따르면, ARIMA, LSTM, Hybrid 모델을 비교한 결과, 마지막이 가장 우수한 성능을 보였다. 

![스크린샷 2021-03-14 오후 3.39.38](https://i.imgur.com/ZgKx9NI.png)

이러한 선례는 다른 딥러닝 모델과 통계 모델이 결합했을 때 좋은 성능을 낼 가능성을 암시한다. 즉, 통계 모델이 여전히 필요하다는 것이다. 